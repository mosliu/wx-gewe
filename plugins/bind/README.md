# Bind Plugin

## 简介

Bind Plugin 是一个用于绑定用户或群组的插件，通过绑定密钥将微信用户或群组与系统中的客户关联起来。该插件允许用户通过发送特定格式的命令来完成绑定操作。

## 功能特点

- 支持用户绑定：将个人微信账号与系统客户关联
- 支持群组绑定：将微信群与系统客户关联
- 使用唯一的绑定密钥进行验证
- 绑定状态持久化到数据库

## 安装

该插件是系统的核心组件，默认已集成在系统中，无需额外安装步骤。

## 配置

插件配置位于全局配置文件 `plugins/config.yaml` 中：

```yaml
bind:
  enabled: true
  priority: 10
  module_name: bind_plugin
  class_name: BindPlugin
  config:
    bind_command: "/bind"
    bind_help_message: "请输入正确的绑定格式：/bind <key>"
```

## 使用方法

### 用户绑定

个人用户可以通过发送以下命令进行绑定：

```
/bind your_bind_key
```

### 群组绑定

在群聊中，管理员可以通过发送以下命令进行群组绑定：

```
/bind your_bind_key
```

## 绑定流程

1. 系统管理员在后台为客户生成绑定密钥
2. 用户或群组管理员通过 `/bind` 命令使用该密钥进行绑定
3. 系统验证密钥的有效性
4. 如果密钥有效，系统将用户或群组与对应的客户关联
5. 绑定成功后，用户或群组可以使用系统的其他功能

## 数据库表

该插件使用以下数据库表：

- `CustomBindKey`: 存储绑定密钥信息
- `WxUser`: 存储已绑定的用户信息
- `WxGroup`: 存储已绑定的群组信息

## 开发说明

插件实现了 `process` 方法来处理绑定请求：

1. 检查消息是否以 `/bind` 开头
2. 提取绑定密钥
3. 验证密钥的有效性
4. 根据消息来源（个人或群组）执行相应的绑定操作
5. 更新数据库记录
6. 返回绑定结果
